<div class="container py-5" style="max-width: 800px;">
  <div *ngIf="joke$ | async as joke; else notFound">
    <div class="card shadow rounded-3 p-4">
      <div class="joke-meta mb-4 pb-3 border-bottom">
        <span class="joke-author">
          <i class="fa fa-user"></i>{{ joke.author }}
        </span>
        <span class="joke-date">
          <i class="fa fa-clock-o"></i>{{ joke.createdAt | date:'dd/MM/yyyy' }}
        </span>
        <span class="joke-category text-capitalize">
          <i class="fa fa-folder"></i>{{ joke.type }}
        </span>
        <span class="joke-views">
          <i class="fa fa-eye"></i>{{ joke.views || 0 }}
        </span>
      </div>

      <div class="mb-4">
        <h2 class="fw-semibold mb-3">{{ joke.setup }}</h2>

        <div class="joke-punchline">
          <p class="fs-5 mb-0">{{ joke.punchline }}</p>
        </div>
      </div>

      <div class="d-flex flex-wrap gap-2">
        <button
          *ngIf="userStore.isLoggedIn()"
          class="btn btn-outline-primary"
          (click)="toggleFavorite(joke)">
          <i class="bi" [ngClass]="joke.favorite ? 'bi-star-fill' : 'bi-star'"></i>
          {{ joke.favorite ? 'Unfavorite' : 'Favorite' }}
        </button>
        <a *ngIf="canEdit(joke)" [routerLink]="['/jokes/edit', joke.id]" class="btn btn-outline-secondary">
          <i class="bi bi-pencil"></i> Edit
        </a>
        <button
          *ngIf="userStore.isAdmin()"
          class="btn btn-outline-danger"
          (click)="deleteJoke(joke)">
          <i class="bi bi-trash"></i> Delete
        </button>
        <button (click)="goBack()" class="btn btn-outline-secondary">
          <i class="bi bi-arrow-left"></i> Back
        </button>
      </div>
    </div>
  </div>

  <ng-template #notFound>
    <div class="card shadow rounded-3 p-5">
      <div class="text-center">
        <i class="bi bi-emoji-frown display-1 text-muted mb-3"></i>
        <h4 class="fw-semibold mb-2">Joke Not Found</h4>
        <p class="text-muted mb-4">The joke you're looking for doesn't exist.</p>
        <button (click)="goBack()" class="btn btn-primary">
          <i class="bi bi-arrow-left"></i> Back to List
        </button>
      </div>
    </div>
  </ng-template>
</div>
